<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Taller de Autos Concurrente</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link
        rel="stylesheet"
        href="{{ url_for('static', filename='css/styles.css') }}"
    >
</head>
<body>
<div class="app-shell">
    <header class="app-header">
        <div class="app-header-icon">üöó</div>
        <div>
            <h1 class="app-title">Taller de Autos Concurrente</h1>
            <p class="app-subtitle">
                Simulaci√≥n de asignaci√≥n de √≥rdenes con 3 talleres (3 hilos).
            </p>
        </div>
    </header>

    <main class="app-main">
        <!-- PANEL IZQUIERDO: FORMULARIO Y √ìRDENES -->
        <section class="column column-left">

            <!-- Registrar orden -->
            <section class="card">
                <div class="card-header">
                    <h2>Registrar orden</h2>
                    <p class="card-caption">
                        √ìrdenes registradas:
                        <span class="badge">
                            {{ orders|length }}
                        </span>
                    </p>
                </div>

                <form class="form-grid" action="{{ url_for('add_order_route') }}" method="post">
                    <!-- Trabajo / orden -->
                    <div class="form-field">
                        <label for="description">Trabajo / orden</label>
                        <div class="input-with-dropdown">
                            <input
                                id="description"
                                name="description"
                                type="text"
                                placeholder="Escribe o elige un trabajo t√≠pico"
                                autocomplete="off"
                            >
                            <ul id="order-suggestions" class="suggestions-list"></ul>
                        </div>
                    </div>

                    <!-- Tiempo l√≥gico -->
                    <div class="form-field inline">
                        <label for="prep_time">Tiempo l√≥gico (unidades simuladas)</label>
                        <input
                          type="number"
                          id="prep_time"
                          name="prep_time"
                          min="1"
                          placeholder="Tiempo l√≥gico (1 ‚Üí N)"
                          value=""
                          autocomplete="off"
                        />

                    </div>

                    <!-- Prioridad -->
                    <div class="form-field inline">
                        <label for="priority">Prioridad</label>
                        <select id="priority" name="priority" autocomplete="off" required>
                        <option value="" selected disabled>Selecciona prioridad</option>
                        <option value="1">1 - Baja</option>
                        <option value="2">2 - Media</option>
                        <option value="3">3 - Alta</option>
                      </select>

                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn primary">
                            Agregar orden
                        </button>
                    </div>
                </form>

                <form class="form-actions dual" action="{{ url_for('process_orders_route') }}" method="post">
                    <button type="submit" class="btn success">
                        Procesar √≥rdenes
                    </button>
                </form>

                <form class="form-actions dual" action="{{ url_for('reset_route') }}" method="post">
                    <button type="submit" class="btn ghost">
                        Reiniciar simulaci√≥n
                    </button>
                </form>
            </section>

            <!-- √ìrdenes registradas -->
            <section class="card">
                <div class="card-header">
                    <h2>√ìrdenes registradas</h2>
                </div>

                {% if orders %}
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Descripci√≥n</th>
                                <th>Tiempo</th>
                                <th>Prioridad</th>
                                <th>Estado</th>
                                <th>Taller</th>
                            </tr>
                            </thead>
                            <tbody id="orders-tbody">
                              {% for o in orders %}
                              <tr>
                                <td>{{ o.id }}</td>
                                <td>{{ o.description }}</td>
                                <td>{{ o.prep_time }}</td>
                                <td>{{ o.priority }}</td>
                                <td>{{ o.worker_id }}</td>
                                <td>{{ o.status }}</td>
                              </tr>
                              {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="empty-text">
                        A√∫n no has registrado √≥rdenes.
                    </p>
                {% endif %}
            </section>
        </section>

        <!-- PANEL DERECHO: LOGS -->
        <section class="column column-right">
            <section class="card card-logs">
                <div class="card-header">
                    <h2>Secuencia de eventos</h2>
                </div>

                {% if logs %}
                    <div id="logs-box" class="logs-box">
                      {% for line in logs %}
                        <div>{{ line }}</div>
                      {% endfor %}
                    </div>
                {% else %}
                    <p class="empty-text">
                        A√∫n no hay logs. Registra √≥rdenes y luego procesa.
                    </p>
                {% endif %}
            </section>
        </section>
    </main>

    <footer class="app-footer">
        Simulaci√≥n acad√©mica de concurrencia con Python, hilos y Flask.
    </footer>
</div>

<!-- JSON con las tareas sugeridas para el JS -->
<script id="tasks-data" type="application/json">
    {{ tasks|tojson }}
</script>

<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
